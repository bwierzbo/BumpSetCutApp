---
name: Modify VideoProcessor to Generate Metadata
status: open
created: 2025-09-13T15:19:39Z
updated: 2025-09-13T15:19:39Z
github: [Will be updated when synced to GitHub]
depends_on: [001, 002]
parallel: false
conflicts_with: [003]
---

# Task: Modify VideoProcessor to Generate Metadata

## Description
Modify the existing VideoProcessor to generate ProcessingMetadata instead of creating annotated video files in production mode. This maintains the current detection and tracking pipeline while changing the output format to metadata persistence.

## Acceptance Criteria
- [ ] VideoProcessor generates ProcessingMetadata during processing
- [ ] Rally detection results captured as rally timestamps with confidence scores
- [ ] Ball trajectory data saved as frame-by-frame position coordinates
- [ ] Court detection and processing statistics included in metadata
- [ ] Metadata saved via MetadataStore service after successful processing
- [ ] Debug mode still generates annotated videos when enabled

## Technical Details
- **Location**: `BumpSetCut/Domain/Services/VideoProcessor.swift` (existing file)
- **Implementation approach**:
  - Extract metadata generation logic from existing processing pipeline
  - Modify processVideo method to return metadata instead of video files
  - Preserve existing debug video generation for development builds
- **Key considerations**:
  - Maintain exact same detection/tracking algorithms for consistency
  - Ensure processing performance is not degraded
  - Keep debug video functionality for algorithm validation
- **Files affected**: VideoProcessor.swift, related processing service files

## Dependencies
- [ ] Task 001: ProcessingMetadata model structure
- [ ] Task 002: MetadataStore service for persistence
- [ ] Review existing VideoProcessor detection/tracking pipeline

## Effort Estimate
- Size: L
- Hours: 16 hours
- Parallel: false (core processing changes)

## Definition of Done
- [ ] VideoProcessor modified to generate metadata output
- [ ] All existing detection algorithms preserved and tested
- [ ] Metadata generation covers rally timestamps and ball trajectories
- [ ] Performance benchmarks maintained or improved
- [ ] Debug video generation preserved for development builds
- [ ] Integration tests validate metadata accuracy against known videos