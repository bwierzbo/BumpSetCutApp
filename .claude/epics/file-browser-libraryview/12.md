---
name: Data Model Extension
status: open
created: 2025-09-01T18:57:30Z
updated: 2025-09-01T19:08:34Z
github: https://github.com/bwierzbo/BumpSetCutApp/issues/12
depends_on: []
parallel: false
conflicts_with: []
---

# Data Model Extension

## Description
Extend the MediaStore data model to support folder management and enhanced video metadata for the library view. This involves adding folder entities, updating video entities to support folder relationships, and implementing the necessary database schema changes.

## Acceptance Criteria
- [ ] Add `Folder` entity with properties: id, name, parentId, createdAt, updatedAt, path
- [ ] Update `Video` entity to include folderId foreign key relationship
- [ ] Implement folder hierarchy support with proper parent-child relationships
- [ ] Add video metadata fields: duration, fileSize, resolution, codec information
- [ ] Create database migrations for schema changes
- [ ] Implement folder CRUD operations in MediaStore
- [ ] Add proper indexing for performance on folder and video queries
- [ ] Ensure referential integrity with cascading deletes/updates

## Technical Details

### Files to Modify/Create:
- `/BumpSetCut/Data/Storage/MediaStore.swift` - Core data model updates
- `/BumpSetCut/Data/Storage/Migrations/` - New migration files
- Database schema definition files

### Implementation Approach:
1. **Folder Entity Design:**
   - Use hierarchical structure with parentId for nested folders
   - Implement path field for efficient navigation
   - Add validation for circular references

2. **Video Entity Updates:**
   - Add optional folderId foreign key
   - Extend metadata fields for better library organization
   - Maintain backward compatibility with existing videos

3. **Database Schema:**
   - Create proper indexes for folder hierarchy queries
   - Add constraints for referential integrity
   - Plan migration strategy for existing data

4. **MediaStore Operations:**
   - Implement folder management methods
   - Update video queries to include folder context
   - Add batch operations for folder/video relationships

## Dependencies
This is a foundation task with no dependencies. All other tasks in this epic depend on this implementation.

## Effort Estimate
- **Size:** M (Medium)
- **Hours:** 12
- **Complexity:** High due to database schema changes and hierarchy implementation

## Definition of Done
- [ ] All acceptance criteria completed
- [ ] Database migrations tested and working
- [ ] Unit tests for new MediaStore operations
- [ ] Integration tests for folder-video relationships
- [ ] Performance tests for hierarchical queries
- [ ] Code review completed
- [ ] Documentation updated for new data model
- [ ] Backward compatibility verified with existing data
