---
name: Enhance TikTokRallyPlayerView Gesture Handling
status: open
created: 2025-09-17T00:31:13Z
updated: 2025-09-17T00:37:00Z
github: https://github.com/bwierzbo/BumpSetCutApp/issues/41
depends_on: []
parallel: true
conflicts_with: [42]
---

# Task: Enhance TikTokRallyPlayerView Gesture Handling

## Description

Extend the existing TikTokRallyPlayerView gesture recognizers to emit peek progress callbacks during swipe gestures. This enables the UI to display preview frames proportionally to swipe distance while maintaining all current Tinder-style rotation animations.

## Acceptance Criteria

- [ ] Existing swipe gesture recognizers emit peek progress values (0.0 to 1.0)
- [ ] Peek callbacks trigger at appropriate threshold (not too sensitive, not too late)
- [ ] Support both vertical (portrait) and horizontal (landscape) swipe directions
- [ ] Maintain all existing Tinder-style rotation animations unchanged
- [ ] Gesture cancellation properly resets peek progress to 0.0
- [ ] No performance impact on existing gesture responsiveness
- [ ] Clean integration with current gesture state management

## Technical Details

**Implementation Location:**
- Modify existing file: `BumpSetCut/Presentation/Views/TikTokRallyPlayerView.swift`
- Extend gesture recognizers within current Presentation layer

**Key Modifications:**
- Add peek progress callback parameter to existing gesture handling
- Modify `DragGesture` to calculate and emit peek progress values
- Integrate peek threshold logic with current swipe threshold system
- Ensure gesture cancellation and completion properly manage peek state

**Code Considerations:**
- Calculate peek progress as percentage of swipe distance to complete threshold
- Use existing gesture translation values to determine direction and progress
- Maintain backward compatibility with current gesture behavior
- Add optional peek callback parameter with default nil value

## Dependencies

- [ ] Current TikTokRallyPlayerView gesture implementation
- [ ] Existing rally navigation and state management
- [ ] Current Tinder-style animation system

## Effort Estimate

- **Size**: M
- **Hours**: 12-16 hours
- **Parallel**: true (can work alongside FrameExtractor development)

## Definition of Done

- [ ] Gesture recognizers emit accurate peek progress during swipe gestures
- [ ] Peek thresholds tuned for optimal user experience
- [ ] All existing gesture functionality preserved and working
- [ ] Gesture cancellation properly handles peek state cleanup
- [ ] Code maintains existing TikTokRallyPlayerView architecture patterns
- [ ] Ready for peek UI overlay integration
